{
  "info": {
    "name": "NosTX API",
    "description": "MVP - Plataforma de Postagens Simult√¢neas em X e Nostr\n\nEsta collection cont√©m todos os endpoints da API NosTX para autentica√ß√£o e publica√ß√£o simult√¢nea em X (Twitter) e Nostr.\n\n**Configura√ß√£o inicial:**\n1. Configure as vari√°veis de ambiente\n2. Execute a autentica√ß√£o (Twitter ou Nostr)\n3. Use o token JWT retornado nas requisi√ß√µes protegidas\n\n**Vari√°veis necess√°rias:**\n- `base_url`: URL base da API (ex: http://localhost:3000)\n- `jwt_token`: Token JWT obtido ap√≥s autentica√ß√£o",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_postman_id": "nostx-api-collection",
    "version": {
      "major": 1,
      "minor": 0,
      "patch": 0
    }
  },
  "item": [
    {
      "name": "Health Check",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/health",
              "host": ["{{base_url}}"],
              "path": ["health"]
            },
            "description": "Verifica o status da API e obt√©m informa√ß√µes b√°sicas sobre o servi√ßo."
          },
          "response": []
        },
        {
          "name": "API Documentation",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/",
              "host": ["{{base_url}}"],
              "path": [""]
            },
            "description": "Obt√©m a documenta√ß√£o b√°sica da API com todos os endpoints dispon√≠veis."
          },
          "response": []
        }
      ],
      "description": "Endpoints para verificar o status da API e obter documenta√ß√£o."
    },
    {
      "name": "Autentica√ß√£o",
      "item": [
        {
          "name": "Twitter/X",
          "item": [
            {
              "name": "Iniciar Login Twitter",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/auth/twitter/login",
                  "host": ["{{base_url}}"],
                  "path": ["auth", "twitter", "login"]
                },
                "description": "Inicia o fluxo de autentica√ß√£o OAuth 1.0a com Twitter/X. Retorna a URL de autoriza√ß√£o e um sessionId."
              },
              "response": []
            },
            {
              "name": "Callback Twitter",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/auth/twitter/callback?oauth_token=OAUTH_TOKEN&oauth_verifier=OAUTH_VERIFIER&state=SESSION_ID",
                  "host": ["{{base_url}}"],
                  "path": ["auth", "twitter", "callback"],
                  "query": [
                    {
                      "key": "oauth_token",
                      "value": "OAUTH_TOKEN",
                      "description": "Token OAuth retornado pelo Twitter"
                    },
                    {
                      "key": "oauth_verifier",
                      "value": "OAUTH_VERIFIER",
                      "description": "Verificador OAuth retornado pelo Twitter"
                    },
                    {
                      "key": "state",
                      "value": "SESSION_ID",
                      "description": "Session ID retornado no login inicial"
                    }
                  ]
                },
                "description": "Callback autom√°tico do Twitter OAuth. Normalmente chamado automaticamente pelo Twitter ap√≥s autoriza√ß√£o."
              },
              "response": []
            }
          ],
          "description": "Endpoints para autentica√ß√£o com Twitter/X usando OAuth 1.0a."
        },
        {
          "name": "Nostr",
          "item": [
            {
              "name": "Gerar Chave Nostr",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/auth/nostr/generate-key",
                  "host": ["{{base_url}}"],
                  "path": ["auth", "nostr", "generate-key"]
                },
                "description": "Gera uma nova chave privada e p√∫blica para Nostr. Use a chave privada para fazer login."
              },
              "response": []
            },
            {
              "name": "Login com Nostr",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"privateKey\": \"sua-chave-privada-hex-aqui\"\n}"
                },
                "url": {
                  "raw": "{{base_url}}/auth/nostr/login",
                  "host": ["{{base_url}}"],
                  "path": ["auth", "nostr", "login"]
                },
                "description": "Faz login usando uma chave privada Nostr existente. Retorna um token JWT para autentica√ß√£o."
              },
              "response": []
            },
            {
              "name": "Adicionar Nostr a Usu√°rio",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "Authorization",
                    "value": "Bearer {{jwt_token}}"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"privateKey\": \"sua-chave-privada-hex-aqui\"\n}"
                },
                "url": {
                  "raw": "{{base_url}}/auth/nostr/add",
                  "host": ["{{base_url}}"],
                  "path": ["auth", "nostr", "add"]
                },
                "description": "Adiciona autentica√ß√£o Nostr a um usu√°rio j√° existente (que fez login com Twitter). Requer autentica√ß√£o JWT."
              },
              "response": []
            }
          ],
          "description": "Endpoints para autentica√ß√£o com Nostr usando chaves privadas."
        }
      ],
      "description": "Endpoints de autentica√ß√£o para Twitter/X e Nostr. Ap√≥s a autentica√ß√£o, use o token JWT retornado nas requisi√ß√µes protegidas."
    },
    {
      "name": "Posts",
      "item": [
        {
          "name": "Criar e Publicar Post",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"content\": \"Meu primeiro post simult√¢neo no X e Nostr! üöÄ #NosTX\",\n  \"mediaUrls\": [\n    \"https://exemplo.com/imagem1.jpg\",\n    \"https://exemplo.com/imagem2.png\"\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/posts",
              "host": ["{{base_url}}"],
              "path": ["posts"]
            },
            "description": "Cria e publica um post simultaneamente no X (Twitter) e Nostr. O conte√∫do deve ter no m√°ximo 280 caracteres e pode incluir at√© 4 URLs de m√≠dia."
          },
          "response": []
        },
        {
          "name": "Criar Post Simples (Apenas Texto)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"content\": \"Ol√° mundo! Testando a API NosTX üëã\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/posts",
              "host": ["{{base_url}}"],
              "path": ["posts"]
            },
            "description": "Exemplo de post simples apenas com texto, sem m√≠dias."
          },
          "response": []
        },
        {
          "name": "Buscar Post por ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/posts/{{post_id}}",
              "host": ["{{base_url}}"],
              "path": ["posts", "{{post_id}}"]
            },
            "description": "Busca um post espec√≠fico pelo seu ID. Apenas o autor do post pode acess√°-lo."
          },
          "response": []
        },
        {
          "name": "Buscar Logs de Publica√ß√£o",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/posts/{{post_id}}/logs",
              "host": ["{{base_url}}"],
              "path": ["posts", "{{post_id}}", "logs"]
            },
            "description": "Busca os logs detalhados de publica√ß√£o de um post espec√≠fico, incluindo status de sucesso/erro para cada plataforma."
          },
          "response": []
        }
      ],
      "description": "Endpoints para cria√ß√£o, publica√ß√£o e consulta de posts. Todos os endpoints requerem autentica√ß√£o JWT."
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3000",
      "description": "URL base da API NosTX"
    },
    {
      "key": "jwt_token",
      "value": "",
      "description": "Token JWT obtido ap√≥s autentica√ß√£o (Twitter ou Nostr)"
    },
    {
      "key": "post_id",
      "value": "",
      "description": "ID de um post espec√≠fico para consultas"
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Script executado antes de cada requisi√ß√£o",
          "// Voc√™ pode adicionar l√≥gica personalizada aqui se necess√°rio"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Testes autom√°ticos ap√≥s cada requisi√ß√£o",
          "pm.test(\"Status code is not 500\", function () {",
          "    pm.expect(pm.response.code).to.not.equal(500);",
          "});",
          "",
          "// Salva automaticamente o JWT token se retornado",
          "if (pm.response.json() && pm.response.json().token) {",
          "    pm.collectionVariables.set(\"jwt_token\", pm.response.json().token);",
          "    console.log(\"JWT token salvo automaticamente!\");",
          "}",
          "",
          "// Salva automaticamente o post ID se retornado",
          "if (pm.response.json() && pm.response.json().postId) {",
          "    pm.collectionVariables.set(\"post_id\", pm.response.json().postId);",
          "    console.log(\"Post ID salvo automaticamente!\");",
          "}"
        ]
      }
    }
  ]
} 